<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conecta 4 - Versión Simple</title>
    <style>
        /* CSS BÁSICO */
        body {
            font-family: monospace;
            text-align: center;
        }

        #tablero {
            display: grid;
            grid-template-rows: repeat(6, 40px);
            grid-template-columns: repeat(7, 40px);
            gap: 1px;
            margin: 10px auto;
            border: 2px solid black;
            background-color: #AAAAFF; /* Azul simple */
            width: fit-content;
        }

        .celda {
            width: 40px;
            height: 40px;
            border: 1px solid #333;
            background-color: white;
            font-size: 0; /* Oculta el contenido si no hay ficha */
        }

        /* Clases de fichas simples */
        .ficha-R {
            background-color: red;
        }

        .ficha-A {
            background-color: yellow;
        }

        #mensaje {
            margin: 10px;
            font-weight: bold;
            font-size: 1.2em;
        }

        .columna-index {
            display: grid;
            grid-template-columns: repeat(7, 40px);
            width: fit-content;
            margin: 0 auto;
            gap: 1px;
        }
        .columna-index div {
            padding: 5px 0;
            border: 1px solid #000;
            cursor: pointer;
            background-color: #EEE;
        }
    </style>
</head>
<body>

    <h1>C O N E C T A - 4</h1>
    <div id="mensaje">Turno: **Rojo** (R)</div>

    <div class="columna-index" id="indices">
        </div>

    <div id="tablero">
        </div>
    
    <script>
        const FILAS = 6;
        const COLUMNAS = 7;
        const JUGADOR_ROJO = 'R';
        const JUGADOR_AMARILLO = 'A';
        const VACIO = ' ';

        let tablero;
        let jugadorActual;
        let juegoTerminado = false;

        const tableroElemento = document.getElementById('tablero');
        const mensajeElemento = document.getElementById('mensaje');
        const indicesElemento = document.getElementById('indices');

        // --- Lógica del Juego (Simplificada del Java original) ---

        function inicializarTablero() {
            tablero = Array(FILAS).fill(null).map(() => Array(COLUMNAS).fill(VACIO));
            jugadorActual = JUGADOR_ROJO;
            juegoTerminado = false;
            mensajeElemento.textContent = `Turno: ${jugadorActual === JUGADOR_ROJO ? 'Rojo (R)' : 'Amarillo (A)'}`;
            dibujarTablero();
            dibujarIndices();
        }

        function dibujarIndices() {
            indicesElemento.innerHTML = '';
            for (let j = 0; j < COLUMNAS; j++) {
                const indice = document.createElement('div');
                indice.textContent = j;
                indice.dataset.columna = j;
                indice.onclick = () => manejarMovimiento(j);
                indicesElemento.appendChild(indice);
            }
        }

        function dibujarTablero() {
            tableroElemento.innerHTML = '';
            for (let i = 0; i < FILAS; i++) {
                for (let j = 0; j < COLUMNAS; j++) {
                    const celda = document.createElement('div');
                    celda.classList.add('celda');
                    if (tablero[i][j] !== VACIO) {
                        celda.classList.add(`ficha-${tablero[i][j]}`);
                    }
                    tableroElemento.appendChild(celda);
                }
            }
        }

        function colocarFicha(columna, jugador) {
            for (let i = FILAS - 1; i >= 0; i--) {
                if (tablero[i][columna] === VACIO) {
                    tablero[i][columna] = jugador;
                    return i;
                }
            }
            return -1;
        }

        function tableroLleno() {
            return tablero[0].every(celda => celda !== VACIO);
        }

        function verificarLinea(r, c, dr, dc, jugador) {
            for (let i = 0; i < 4; i++) {
                const fila = r + i * dr;
                const columna = c + i * dc;
                if (fila < 0 || fila >= FILAS || columna < 0 || columna >= COLUMNAS || tablero[fila][columna] !== jugador) {
                    return false;
                }
            }
            return true;
        }

        function hayGanador(jugador) {
            const direcciones = [
                [0, 1], [1, 0], [1, 1], [1, -1] // Horizontal, Vertical, Diagonal (2)
            ];

            for (let i = 0; i < FILAS; i++) {
                for (let j = 0; j < COLUMNAS; j++) {
                    if (tablero[i][j] === jugador) {
                        for (const [dr, dc] of direcciones) {
                            if (verificarLinea(i, j, dr, dc, jugador)) return true;
                        }
                    }
                }
            }
            return false;
        }

        function manejarMovimiento(columna) {
            if (juegoTerminado) {
                if (confirm("Juego terminado. ¿Quieres jugar de nuevo?")) {
                    inicializarTablero();
                    return;
                }
                return;
            }

            const fila = colocarFicha(columna, jugadorActual);

            if (fila !== -1) {
                // Redibujar solo la celda afectada para simular un cambio rápido (aunque aquí redibujamos todo el tablero)
                dibujarTablero();

                if (hayGanador(jugadorActual)) {
                    juegoTerminado = true;
                    mensajeElemento.textContent = `¡El jugador ${jugadorActual === JUGADOR_ROJO ? 'Rojo (R)' : 'Amarillo (A)'} ha ganado! ¡Haz clic para reiniciar!`;
                } else if (tableroLleno()) {
                    juegoTerminado = true;
                    mensajeElemento.textContent = "¡Empate! Tablero lleno. ¡Haz clic para reiniciar!";
                } else {
                    jugadorActual = (jugadorActual === JUGADOR_ROJO) ? JUGADOR_AMARILLO : JUGADOR_ROJO;
                    mensajeElemento.textContent = `Turno: ${jugadorActual === JUGADOR_ROJO ? 'Rojo (R)' : 'Amarillo (A)'}`;
                }
            } else {
                mensajeElemento.textContent = `Columna ${columna} llena. ¡Intenta de nuevo, ${jugadorActual === JUGADOR_ROJO ? 'Rojo' : 'Amarillo'}!`;
            }
        }

        // Inicia el juego y permite reiniciar haciendo clic en el mensaje
        window.onload = () => {
            inicializarTablero();
            mensajeElemento.onclick = () => {
                if (juegoTerminado) inicializarTablero();
            };
        };
    </script>

</body>
</html>